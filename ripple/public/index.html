<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Basic Socket template</title>
    <style>
        body,
        html {
            height: 100%;
            width: 100%;
            margin: 0px;
        }

        body {
            overflow: hidden;
        }
    </style>
</head>

<body>
    <audio id="audioPlayer" src="./water effect echo.mp3" preload="auto" type="audio/mpeg" ></audio>

<svg id="ripple-template" version="1.1" viewBox="-250 -250 500 500" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid" >

    <path r="5" fill="none" stroke="#8800ff" stroke-width="3" d="M39.97 42.28c-3.1-5.22-9.04-8.12-15.06-7.03-3.22.58-5.71 2.48-8.11 4.58a59.482 59.482 0 0 0-7.48 7.82c-4.26 5.36-8 11.49-9.05 18.37-.97 6.3.6 12.8 5.72 16.94 4.14 3.34 9.34 4.72 14.37 6.1 4.69 1.28 9.73 2.54 13.06 6.1 3.68 3.93 3.53 9.57 2.57 14.63-1.17 6.16-3.22 12.16-3.59 18.46-.81 13.98 10.43 24.65 22.09 30.4 6.41 3.17 13.62 5.13 20.81 4.57 6.47-.51 12.5-3.01 17.34-7.35 4.48-4.02 7.54-9.53 8.12-15.56.55-5.68-1.58-11.26-1.32-16.94.09-2.03.66-4.01 2.31-5.19 2.3-1.63 5.47-1.24 7.99-.58 5.19 1.35 9.61 4.79 13.86 7.95 4.42 3.28 8.92 6.6 14.23 8.28 5.96 1.88 12.49 1.06 17.88-2.07 5.52-3.2 9.49-8.71 10.49-15.04 1.03-6.53-.67-13.24-4.98-18.3-6.01-7.06-21.02-12.32-15.98-23.96 2.34-5.4 7.21-9.54 11.4-13.48 4.93-4.63 9.33-9.63 12.81-15.45 3.43-5.74 6-12.06 7.51-18.57 1.11-4.79 2.05-9.99 1.12-14.89-.91-4.79-4.13-8.46-8.65-10.2C166.16.61 162.44.45 158.99.21c-3.97-.28-7.96-.3-11.92.06-6.96.63-13.89 2.28-19.94 5.89-5.75 3.43-10.29 8.41-12.74 14.67-2.49 6.34-2.61 13.33-3.06 20.03-.42 6.26-1.06 13.16-4.9 18.38-1.63 2.22-4.01 4.2-6.79 4.69-2.81.49-5.62-.87-7.79-2.55-4.03-3.12-6.1-7.9-7.29-12.74-1.35-5.51-1.66-11.22-2-16.86-.37-6.07-.68-12.23-3.22-17.86-2.56-5.67-8.06-10.6-14.58-10.43-6.28.16-11.07 4.79-11.82 10.9-.65 5.27 1.15 10.61 2.05 15.75.83 4.69 1.22 10.14-2.83 13.51a10.052 10.052 0 0 1-6.38 2.3c-1.08 0-2.2-.15-3.19-.64-1.18-.61-1.96-1.9-2.62-3.03-1.64-2.76-5.96-.25-4.32 2.53 1.75 2.96 4.07 5.24 7.54 5.88 2.96.55 5.92.14 8.67-1.05 5.5-2.39 8.44-7.6 8.66-13.46.19-5.31-1.46-10.5-2.33-15.69-.71-4.27-.83-8.83 3.32-11.12 5.14-2.83 10.53 1.39 12.91 5.83 2.64 4.93 2.8 10.79 3.13 16.25.65 10.68 1.02 23.2 8.7 31.55 4.41 4.79 11.13 7.64 17.4 4.89 5.95-2.61 9.41-8.8 11-14.83 1.71-6.48 1.62-13.25 2.22-19.88.55-6.03 1.89-12.2 5.92-16.93 9.1-10.66 24.59-12.02 37.64-10.9 2.83.24 5.99.43 8.46 1.74 1.04.56 1.48.88 2.24 1.69.17.18.33.36.48.55-.07-.09-.23-.33.04.07.31.45.58.92.83 1.41.02.05.31.74.12.24.08.21.16.42.23.64.14.43.26.86.35 1.29.05.22.09.43.13.65.02.09.11.81.04.19.06.49.09.98.11 1.47.07 2-.15 4.01-.46 5.98-2.01 12.84-8.15 24.87-17.49 33.92-7.86 7.62-20.33 17.45-14.96 29.91 2.23 5.18 7.07 8.43 11.41 11.71 2.05 1.55 4.07 3.19 5.74 5.16 1.79 2.11 2.91 4.72 3.48 7.41 1.17 5.54-.45 11.46-4.51 15.44-3.79 3.72-9.53 5.8-14.82 4.86-5.21-.92-9.64-3.97-13.82-7.03-4.45-3.26-8.79-6.72-13.93-8.84-5.25-2.16-12.51-3.01-16.74 1.62-3.97 4.34-3 10.66-2.24 15.97.37 2.6.82 5.23.71 7.86-.1 2.56-.87 5.07-2.1 7.3-2.63 4.79-7.2 8.55-12.35 10.36-12.37 4.34-26.61-1.83-35.71-10.32-4.38-4.08-7.98-9.33-8.29-15.48-.29-5.84 1.54-11.52 2.82-17.14 1.27-5.57 2.31-11.68.06-17.15-2.19-5.34-6.72-8.55-11.97-10.54-8.37-3.18-21.93-3.6-23.28-14.72-.74-6.07 2.12-12.12 5.4-17.04a55.09 55.09 0 0 1 6.73-8.2c2.01-2.02 4.27-4.5 6.92-5.65 4.25-1.84 9.17.11 11.56 4.13 1.67 2.76 5.99.25 4.35-2.53Z">

        <animateTransform
            attributeName="transform"
            attributeType="XML"
            type="rotate"
            from="0 50 70"
            to="180 60 20"
            dur="10s"
            repeatCount="indefinite" />

        <animateTransform
        attributeName="transform"
        attributeType="XML"
        type="scale"
        from="0 0"
        to="4 4"
        dur="10s"
        repeatCount="indefinite"> </animateTransform>
        

            <animate attributeName="opacity" dur="2s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1"
                calcMode="spline" begin="0s" fill="freeze"></animate>
    </path>
    
        <path r="5" fill="none" stroke="#77ff00" stroke-width="1" d="M39.97 42.28c-3.1-5.22-9.04-8.12-15.06-7.03-3.22.58-5.71 2.48-8.11 4.58a59.482 59.482 0 0 0-7.48 7.82c-4.26 5.36-8 11.49-9.05 18.37-.97 6.3.6 12.8 5.72 16.94 4.14 3.34 9.34 4.72 14.37 6.1 4.69 1.28 9.73 2.54 13.06 6.1 3.68 3.93 3.53 9.57 2.57 14.63-1.17 6.16-3.22 12.16-3.59 18.46-.81 13.98 10.43 24.65 22.09 30.4 6.41 3.17 13.62 5.13 20.81 4.57 6.47-.51 12.5-3.01 17.34-7.35 4.48-4.02 7.54-9.53 8.12-15.56.55-5.68-1.58-11.26-1.32-16.94.09-2.03.66-4.01 2.31-5.19 2.3-1.63 5.47-1.24 7.99-.58 5.19 1.35 9.61 4.79 13.86 7.95 4.42 3.28 8.92 6.6 14.23 8.28 5.96 1.88 12.49 1.06 17.88-2.07 5.52-3.2 9.49-8.71 10.49-15.04 1.03-6.53-.67-13.24-4.98-18.3-6.01-7.06-21.02-12.32-15.98-23.96 2.34-5.4 7.21-9.54 11.4-13.48 4.93-4.63 9.33-9.63 12.81-15.45 3.43-5.74 6-12.06 7.51-18.57 1.11-4.79 2.05-9.99 1.12-14.89-.91-4.79-4.13-8.46-8.65-10.2C166.16.61 162.44.45 158.99.21c-3.97-.28-7.96-.3-11.92.06-6.96.63-13.89 2.28-19.94 5.89-5.75 3.43-10.29 8.41-12.74 14.67-2.49 6.34-2.61 13.33-3.06 20.03-.42 6.26-1.06 13.16-4.9 18.38-1.63 2.22-4.01 4.2-6.79 4.69-2.81.49-5.62-.87-7.79-2.55-4.03-3.12-6.1-7.9-7.29-12.74-1.35-5.51-1.66-11.22-2-16.86-.37-6.07-.68-12.23-3.22-17.86-2.56-5.67-8.06-10.6-14.58-10.43-6.28.16-11.07 4.79-11.82 10.9-.65 5.27 1.15 10.61 2.05 15.75.83 4.69 1.22 10.14-2.83 13.51a10.052 10.052 0 0 1-6.38 2.3c-1.08 0-2.2-.15-3.19-.64-1.18-.61-1.96-1.9-2.62-3.03-1.64-2.76-5.96-.25-4.32 2.53 1.75 2.96 4.07 5.24 7.54 5.88 2.96.55 5.92.14 8.67-1.05 5.5-2.39 8.44-7.6 8.66-13.46.19-5.31-1.46-10.5-2.33-15.69-.71-4.27-.83-8.83 3.32-11.12 5.14-2.83 10.53 1.39 12.91 5.83 2.64 4.93 2.8 10.79 3.13 16.25.65 10.68 1.02 23.2 8.7 31.55 4.41 4.79 11.13 7.64 17.4 4.89 5.95-2.61 9.41-8.8 11-14.83 1.71-6.48 1.62-13.25 2.22-19.88.55-6.03 1.89-12.2 5.92-16.93 9.1-10.66 24.59-12.02 37.64-10.9 2.83.24 5.99.43 8.46 1.74 1.04.56 1.48.88 2.24 1.69.17.18.33.36.48.55-.07-.09-.23-.33.04.07.31.45.58.92.83 1.41.02.05.31.74.12.24.08.21.16.42.23.64.14.43.26.86.35 1.29.05.22.09.43.13.65.02.09.11.81.04.19.06.49.09.98.11 1.47.07 2-.15 4.01-.46 5.98-2.01 12.84-8.15 24.87-17.49 33.92-7.86 7.62-20.33 17.45-14.96 29.91 2.23 5.18 7.07 8.43 11.41 11.71 2.05 1.55 4.07 3.19 5.74 5.16 1.79 2.11 2.91 4.72 3.48 7.41 1.17 5.54-.45 11.46-4.51 15.44-3.79 3.72-9.53 5.8-14.82 4.86-5.21-.92-9.64-3.97-13.82-7.03-4.45-3.26-8.79-6.72-13.93-8.84-5.25-2.16-12.51-3.01-16.74 1.62-3.97 4.34-3 10.66-2.24 15.97.37 2.6.82 5.23.71 7.86-.1 2.56-.87 5.07-2.1 7.3-2.63 4.79-7.2 8.55-12.35 10.36-12.37 4.34-26.61-1.83-35.71-10.32-4.38-4.08-7.98-9.33-8.29-15.48-.29-5.84 1.54-11.52 2.82-17.14 1.27-5.57 2.31-11.68.06-17.15-2.19-5.34-6.72-8.55-11.97-10.54-8.37-3.18-21.93-3.6-23.28-14.72-.74-6.07 2.12-12.12 5.4-17.04a55.09 55.09 0 0 1 6.73-8.2c2.01-2.02 4.27-4.5 6.92-5.65 4.25-1.84 9.17.11 11.56 4.13 1.67 2.76 5.99.25 4.35-2.53Z">
    
            <animate attributeName="opacity" dur="0.6s" values="0;0" keyTimes="0;1" keySplines="0.2 0 0.8 1"
            calcMode="spline" begin="0s" fill="freeze"></animate>
            <animateTransform
            attributeName="transform"
            attributeType="XML"
            type="scale"
            from="1 1"
            to="3 3"
            dur="10s"
            repeatCount="indefinite"> </animateTransform>
            <animateTransform
            attributeName="transform"
            attributeType="XML"
            type="rotate"
            from="0 60 70"
            to="360 60 70"
            dur="10s"
            repeatCount="indefinite" />
        <animate attributeName="opacity" dur="2s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1"
            calcMode="spline" begin="0.6s" fill="freeze"></animate>
    
    </path>


        <path r="5" fill="none" stroke="#ff00a2" stroke-width="8" d="M39.97 42.28c-3.1-5.22-9.04-8.12-15.06-7.03-3.22.58-5.71 2.48-8.11 4.58a59.482 59.482 0 0 0-7.48 7.82c-4.26 5.36-8 11.49-9.05 18.37-.97 6.3.6 12.8 5.72 16.94 4.14 3.34 9.34 4.72 14.37 6.1 4.69 1.28 9.73 2.54 13.06 6.1 3.68 3.93 3.53 9.57 2.57 14.63-1.17 6.16-3.22 12.16-3.59 18.46-.81 13.98 10.43 24.65 22.09 30.4 6.41 3.17 13.62 5.13 20.81 4.57 6.47-.51 12.5-3.01 17.34-7.35 4.48-4.02 7.54-9.53 8.12-15.56.55-5.68-1.58-11.26-1.32-16.94.09-2.03.66-4.01 2.31-5.19 2.3-1.63 5.47-1.24 7.99-.58 5.19 1.35 9.61 4.79 13.86 7.95 4.42 3.28 8.92 6.6 14.23 8.28 5.96 1.88 12.49 1.06 17.88-2.07 5.52-3.2 9.49-8.71 10.49-15.04 1.03-6.53-.67-13.24-4.98-18.3-6.01-7.06-21.02-12.32-15.98-23.96 2.34-5.4 7.21-9.54 11.4-13.48 4.93-4.63 9.33-9.63 12.81-15.45 3.43-5.74 6-12.06 7.51-18.57 1.11-4.79 2.05-9.99 1.12-14.89-.91-4.79-4.13-8.46-8.65-10.2C166.16.61 162.44.45 158.99.21c-3.97-.28-7.96-.3-11.92.06-6.96.63-13.89 2.28-19.94 5.89-5.75 3.43-10.29 8.41-12.74 14.67-2.49 6.34-2.61 13.33-3.06 20.03-.42 6.26-1.06 13.16-4.9 18.38-1.63 2.22-4.01 4.2-6.79 4.69-2.81.49-5.62-.87-7.79-2.55-4.03-3.12-6.1-7.9-7.29-12.74-1.35-5.51-1.66-11.22-2-16.86-.37-6.07-.68-12.23-3.22-17.86-2.56-5.67-8.06-10.6-14.58-10.43-6.28.16-11.07 4.79-11.82 10.9-.65 5.27 1.15 10.61 2.05 15.75.83 4.69 1.22 10.14-2.83 13.51a10.052 10.052 0 0 1-6.38 2.3c-1.08 0-2.2-.15-3.19-.64-1.18-.61-1.96-1.9-2.62-3.03-1.64-2.76-5.96-.25-4.32 2.53 1.75 2.96 4.07 5.24 7.54 5.88 2.96.55 5.92.14 8.67-1.05 5.5-2.39 8.44-7.6 8.66-13.46.19-5.31-1.46-10.5-2.33-15.69-.71-4.27-.83-8.83 3.32-11.12 5.14-2.83 10.53 1.39 12.91 5.83 2.64 4.93 2.8 10.79 3.13 16.25.65 10.68 1.02 23.2 8.7 31.55 4.41 4.79 11.13 7.64 17.4 4.89 5.95-2.61 9.41-8.8 11-14.83 1.71-6.48 1.62-13.25 2.22-19.88.55-6.03 1.89-12.2 5.92-16.93 9.1-10.66 24.59-12.02 37.64-10.9 2.83.24 5.99.43 8.46 1.74 1.04.56 1.48.88 2.24 1.69.17.18.33.36.48.55-.07-.09-.23-.33.04.07.31.45.58.92.83 1.41.02.05.31.74.12.24.08.21.16.42.23.64.14.43.26.86.35 1.29.05.22.09.43.13.65.02.09.11.81.04.19.06.49.09.98.11 1.47.07 2-.15 4.01-.46 5.98-2.01 12.84-8.15 24.87-17.49 33.92-7.86 7.62-20.33 17.45-14.96 29.91 2.23 5.18 7.07 8.43 11.41 11.71 2.05 1.55 4.07 3.19 5.74 5.16 1.79 2.11 2.91 4.72 3.48 7.41 1.17 5.54-.45 11.46-4.51 15.44-3.79 3.72-9.53 5.8-14.82 4.86-5.21-.92-9.64-3.97-13.82-7.03-4.45-3.26-8.79-6.72-13.93-8.84-5.25-2.16-12.51-3.01-16.74 1.62-3.97 4.34-3 10.66-2.24 15.97.37 2.6.82 5.23.71 7.86-.1 2.56-.87 5.07-2.1 7.3-2.63 4.79-7.2 8.55-12.35 10.36-12.37 4.34-26.61-1.83-35.71-10.32-4.38-4.08-7.98-9.33-8.29-15.48-.29-5.84 1.54-11.52 2.82-17.14 1.27-5.57 2.31-11.68.06-17.15-2.19-5.34-6.72-8.55-11.97-10.54-8.37-3.18-21.93-3.6-23.28-14.72-.74-6.07 2.12-12.12 5.4-17.04a55.09 55.09 0 0 1 6.73-8.2c2.01-2.02 4.27-4.5 6.92-5.65 4.25-1.84 9.17.11 11.56 4.13 1.67 2.76 5.99.25 4.35-2.53Z">
    
        <animate attributeName="opacity" dur="1.2s" values="0;0" keyTimes="0;1" keySplines="0.2 0 0.8 1"
                calcMode="spline" begin="0s" fill="freeze"></animate>
                <animateTransform
                attributeName="transform"
                attributeType="XML"
                type="scale"
                from="0.5 0.5"
                to="4 4"
                dur="10s"
                repeatCount="indefinite"> </animateTransform>
           
            <animate class="last" attributeName="opacity" dur="2s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1"
                calcMode="spline" begin="1.2s" fill="freeze"></animate>
    </path>

    </svg>

    
</body>
<script src="/socket.io/socket.io.js"></script>
<script>
    let offset_x = 0;

    const socket = io();
    // received a message from the server
    socket.on("msg", msg => {
        console.log(msg);
        socket.emit('dimensions', { width: document.documentElement.clientWidth });
    });

    // received a message from another client
    socket.on("client_msg", msg => {
        console.log(msg);
    });

    socket.on("connect", () => {
        socket.emit("client_msg", "Hello from the client " + socket.id);
    });

    socket.on("ripple", (msg) => {
        add_ripple(msg.x -offset_x, msg.y);
    });

    socket.on("offset_x", (offset) => {
        console.log(offset);
        offset_x = offset;
    });

    // create a ripple on click and send it to the other clients
    document.addEventListener('click', e => {
        add_ripple(e.pageX, e.pageY);
        socket.emit('ripple', { x: offset_x + e.pageX, y: e.pageY });
        let audioPlayer = document.getElementById('audioPlayer');
        audioPlayer.currentTime = 0
        audioPlayer.play();
    });

    function add_ripple(x, y) {
        // make a copy of the ripple template
        let ripple_template = document.getElementById('ripple-template');
        let new_ripple = ripple_template.cloneNode(true);
        // avoid duplicate IDs
        new_ripple.id = 'ripple' + Math.random() * 1000;

        let width = 500;
        let height = 500;
        new_ripple.setAttribute("height", height + "px");
        new_ripple.setAttribute("width", width + "px");
        new_ripple.setAttribute("viewBox", `-${innerWidth/4} -${innerHeight/4} ${600} ${600}`);

        // set center of the ripple at the mouse position
        new_ripple.style.top = y - (height / 2) + 'px';
        new_ripple.style.left = x - (width / 2) + 'px';
        new_ripple.style.display = 'block';
        new_ripple.style.position = 'absolute';
        let animate = new_ripple.querySelector('.last')
        // remove the ripple after the animation ends
        animate.addEventListener('endEvent', () => {
            new_ripple.remove();
        });
        document.body.appendChild(new_ripple);
    }
</script>

</html>